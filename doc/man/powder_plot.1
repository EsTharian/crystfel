.\" powder_plot man page
.\"
.\" Copyright © 2012 Andrew Aquila <andrew.aquila@cfel.de>
.\" Copyright © 2012 Thomas White <taw@physics.org>
.\"
.\" Part of CrystFEL - crystallography with a FEL
.\"

.TH POWDER_PLOT 1
.SH NAME
powder_plot \- generate 1D powder patterns
.SH SYNOPSIS
.PP
.B powder_plot
\fB-i\fR \fIinput.hkl\fR | \fB-i\fR \fIinput.h5\fR | \fB-i\fR \fIinput.stream\fR
\fB-o\fR \fIoutput.dat\fR
[\fB--min=\fR\fI1/d\fR \fB--max=\fR\fI1/d\fR]
[\fIoptions\fR\] \fB...\fR

.PP
.BR powder_plot
\fB-i\fR \fIfile.hkl\fR [\fIoptions\fR\] \fB...\fR [\fB--use-redundancy\fR] [\fB--no-d-scaling\fR]

.PP
.BR powder_plot
\fB-i\fR \fIfile.h5\fR [\fIoptions\fR\] \fB...\fR
\fB-g\fR \fIgeometry.geom\fR
\fB-b\fR \fIbeam.beam\fR [\fB--no-sat-corr\fR] [\fB--ring-corr\fR]

.PP
.BR powder_plot
\fB-i\fR \fIfile.stream\fR [\fIoptions\fR\] \fB...\fR --data=\fItype\fR
[-g \fIgeometry.geom\fR] [-b \fIbeam.beam\fR] [\fB--no-sat-corr\fR] [\fB--only-indexed\fR]
[\fB--use-redundancy\fR] [\fB--ring-corr\fR] [\fB--no-d-scaling\fR]

.PP
.BR powder_plot
\fB--help\fR

.SH DESCRIPTION

powder_plot calculates one dimensional powder traces by summing many individual intensities, Bragg peaks or pixels.  Its input can come from a CrystFEL stream (such as that written by "indexamajig"), an reflection list in CrystFEL format (".hkl" format), or an HDF5 file.

The output of powder_plot consists of a three line header followed by a tab-delimited list of six values:

 1/d of the histogram bin, where d is the Bragg law d spacing in meters
 the total number of peaks (N)
 the total intensity in the N peaks
 the mean intensity of the N peaks
 the standard deviation of the distribution
 the standard deviation of the mean of the data

The sigma of the mean is not the same as the sigma of the intensities
themselves.  The former quantity measures how accurately the mean intensity has
been determined, whereas the latter quantity measures the spread of the
intensities.

.SH DATA TYPE OPTIONS WHEN READING FROM A STREAM

When taking input from stream, the d-spacing for a particular intensity can be
generated in a variety of different ways.  You can choose which one with
\fB--data=\fR\fItype\fR.  Possibilities for \fItype\fR are:
.RS
.IP \fBreflection\fR
.PD
Use peak positions from indexed reflections
.IP \fBhkl\fR
.PD
Use the Miller indices from indexed reflections, combined with a unit cell from PDB file provided with -p.
.IP \fBpeaks\fR
.PD
Use peak positions from peak search
.IP \fBh5\fR
.PD
Use all pixels in the HDF5 file, excluding bad regions
.RE
.PP
The default is \fB--data=d\fR.


.SH HISTOGRAM OPTIONS

You can set the mininum and maximum 1/d values, in units of inverse meters,
with the options \fB-min=\fR\fIn\fR and \fB--max=\fR\fIn\fR.
When taking input from peak positions, The default behaviour is to use the entire detector extent from the geometry description file, which you  with the \fB-g\fR flag.

You can also adjust the number of histogram bins with the option --bins=<n>,
where n is an integer.

Scaling can be set to produce linearly, quadratically or cubically spaced 1/d
values using \fB--spacing=\fR\fItype\fR.  Possibilities for \fItype\fR are:
.RS
.IP \fBlinear\fR
.PD
The resolution shells will have equal widths in terms of 1/d.
.IP \fBwilson\fR
.PD
The resolution shells will be quadratically spaced, giving even spacing in a plot against 1/d^2 (a Wilson plot).
.IP \fBvolume\fR
.PD
The resolution shells will all have equal volumes in reciprocal space.
.RE
.PP
The default is \fB--spacing=linear\fR.

.SH OPTIONS FOR MORE CONTROL

.B
.IP --no-sat-corr
Don't correct values of saturated peaks using the table included in the HDF5 file.
See the help for indexamajig for more information.

.B
.IP --only-indexed
Use with --data=peaks or h5 if you want to use the peak list of only indexed patterns.
This is useful for finding differences between patterns which could be indexed and
those which could not.

.B
.IP --no-d-scaling
Do not scale the intensities in the powder plot by d^2.  This should be used when
creating a powder plot from a reflection list.

.B
.IP --ring-corr
Do not correct for the fractional area sampled of the powder ring.  This might be
useful for detectors with gaps.

.B
.IP --use-redundancy
Divide intensities by the number of measurements (the redundancy column in the
reflection list), and not the number of symmetrical equivalent reflections as the
number of times a reflection occurs in the powder.

.SH AUTHOR
This page was written by Andrew Aquila and Thomas White.

.SH REPORTING BUGS
Report bugs to <taw@physics.org>, or visit <http://www.desy.de/~twhite/crystfel>.

.SH COPYRIGHT AND DISCLAIMER
Copyright © 2012 Andrew Aquila <andrew.aquila@cfel.de>
.PD 0
.LP
Copyright © 2012 Thomas White <taw@physics.org>
.PD
.P
powder_plot is part of CrystFEL.
.P
CrystFEL is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
.P
CrystFEL is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.
.P
You should have received a copy of the GNU General Public License along with CrystFEL.  If not, see <http://www.gnu.org/licenses/>.

.SH SEE ALSO
.BR crystfel (7),
.BR indexamajig (1),
.BR process_hkl (1),
.BR check_hkl (1),
.BR crystfel_geometry (5),
.BR render_hkl (1) .
